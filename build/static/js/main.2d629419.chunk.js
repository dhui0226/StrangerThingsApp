(this.webpackJsonpstrangerthings_app=this.webpackJsonpstrangerthings_app||[]).push([[0],{35:function(e,t,s){"use strict";s.r(t);var n=s(2),c=s.n(n),a=s(6),r=s(3),i=s(1),o=s(14),l=s.n(o),u=s(4),j=s(13),d="https://strangers-things.herokuapp.com/api/2104-UIC-RM-WEB-FT",b=function(e){localStorage.setItem("given-token",e)},p=function(){return localStorage.getItem("given-token")},h=function(){var e=Object(a.a)(c.a.mark((function e(t,s){var n,a,r,i,o=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.length>2&&void 0!==o[2]&&o[2],e.next=3,fetch("".concat(d,"/users/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:t,password:s}})});case 3:return n=e.sent,e.next=6,n.json();case 6:if(a=e.sent,r=a.error,i=a.data,console.log("register",i),!r){e.next=14;break}throw Error(r.message);case 14:i&&i.token&&(b(i.token),alert("Registration Success! Press Log-in to Log In"));case 15:return e.abrupt("return",i);case 16:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),O=function(){var e=Object(a.a)(c.a.mark((function e(t,s){var n,a,r,i,o=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.length>2&&void 0!==o[2]&&o[2],e.next=3,fetch("".concat(d,"/users/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:t,password:s}})});case 3:return n=e.sent,e.next=6,n.json();case 6:if(a=e.sent,r=a.error,i=a.data,console.log("logging in",i),!r){e.next=14;break}throw Error(r.message);case 14:i&&i.token&&b(i.token);case 15:return e.abrupt("return",i);case 16:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),f=s(0),m=function(e){var t=Object(i.useState)(""),s=Object(r.a)(t,2),n=s[0],o=s[1],l=Object(i.useState)(""),u=Object(r.a)(l,2),j=u[0],d=u[1],b=Object(i.useState)(null),p=Object(r.a)(b,2),m=p[0],x=p[1],g=e.setIsLoggedIn;return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("form",{className:"authenticate",onSubmit:function(e){return e.preventDefault()},children:[Object(f.jsx)("h1",{className:"maintitle",children:"Stranger's Things"}),Object(f.jsx)("h1",{className:"login",children:" Log In"}),m?Object(f.jsx)("h2",{className:"error",children:m}):null,Object(f.jsxs)("div",{className:"credentialtools",children:[Object(f.jsx)("input",{type:"text",className:"credential",placeholder:"username",value:n,onChange:function(e){return o(e.target.value)}}),Object(f.jsx)("input",{type:"password",value:j,placeholder:"password",className:"credential",onChange:function(e){return d(e.target.value)}}),Object(f.jsx)("button",{className:"loginbutton",onClick:function(){var e=Object(a.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O(n,j);case 3:e.sent,g(!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),x(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),children:" Log-In "}),Object(f.jsx)("button",{className:"registerbutton",onClick:function(){var e=Object(a.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h(n,j);case 3:e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),x(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),children:" Register "})]})]})})},x=s(16),g=s(17),N=function(e){var t,s=e.publicPosts,n=e.setPublicPosts,o=(e.addPostClicked,e.setAddPostClicked),l=Object(i.useState)(""),u=Object(r.a)(l,2),j=u[0],d=u[1],b=Object(i.useState)(""),h=Object(r.a)(b,2),O=h[0],m=h[1],N=Object(i.useState)(""),v=Object(r.a)(N,2),P=v[0],k=v[1],C=Object(i.useState)(""),y=Object(r.a)(C,2),S=y[0],w=y[1],I=Object(i.useState)(!1),E=Object(r.a)(I,2),T=E[0],F=E[1],L=function(){var e=Object(a.a)(c.a.mark((function e(t){var a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2104-UIC-RM-WEB-FT/posts",{method:"POST",headers:{"Content-type":"Application/json",Authorization:"Bearer ".concat(p())},body:JSON.stringify({post:{title:j,description:O,price:P,location:S,willDeliver:T}})});case 3:return a=e.sent,e.next=6,a.json();case 6:r=e.sent,n([r.data.post].concat(Object(x.a)(s)));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o(!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{className:"addform",children:[Object(f.jsxs)("form",{className:"postadd",onSubmit:L,children:[Object(f.jsx)("h1",{className:"f1",children:"Add New Post"}),Object(f.jsx)("label",{className:"f2",children:"Title"}),Object(f.jsx)("input",{className:"f2field",type:"text",id:"title",onChange:function(e){d(e.target.value)}}),Object(f.jsx)("label",{className:"f2",children:"Description"}),Object(f.jsx)("input",{className:"f2field",type:"text",id:"description",onChange:function(e){m(e.target.value)}}),Object(f.jsx)("label",{className:"f2",children:"Price"}),Object(f.jsx)("input",{className:"f2field",type:"text",id:"price",onChange:function(e){k(e.target.value)}}),Object(f.jsx)("label",{className:"f2",children:"Location"}),Object(f.jsx)("input",{className:"f2field",type:"text",id:"location",onChange:function(e){w(e.target.value)}}),Object(f.jsxs)("div",{className:"box",children:[Object(f.jsx)("label",{className:"f2",children:"Willing to Deliver?"}),Object(f.jsx)("input",(t={className:"f2field"},Object(g.a)(t,"className","check"),Object(g.a)(t,"type","checkbox"),Object(g.a)(t,"onChange",(function(){F(!0)})),t))]}),Object(f.jsx)("button",{className:"create",children:"Create"})]}),Object(f.jsx)("button",{className:"cancelCreate",onClick:q,children:"Close"})]})})},v=function(e){var t=e.publicPosts,s=e.setPublicPosts,n=e.postId,o=e.setPostsId,l=e.showResults,u=e.setShowResults,j=Object(i.useState)(""),d=Object(r.a)(j,2),b=d[0],h=d[1],O=Object(i.useState)(""),m=Object(r.a)(O,2),x=m[0],g=m[1],N=Object(i.useState)(""),v=Object(r.a)(N,2),P=v[0],k=v[1],C=Object(i.useState)(""),y=Object(r.a)(C,2),S=y[0],w=y[1],I=function(){var e=Object(a.a)(c.a.mark((function e(a){var r,i,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2104-UIC-RM-WEB-FT/posts/".concat(n),{method:"PATCH",headers:{"Content-type":"Application/json",Authorization:"Bearer ".concat(p())},body:JSON.stringify({post:{title:b,description:x,price:P,location:S}})});case 3:return r=e.sent,e.next=6,r.json();case 6:(i=e.sent).data.post&&i.data.post.title&&(l=t.map((function(e){return e._id===n?i.data.post:e})),s(l),h(""),g(""),k(""),w(""),o(null));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsx)(f.Fragment,{children:l?Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{className:"editform",children:[Object(f.jsxs)("form",{className:"postedit",onSubmit:I,children:[Object(f.jsx)("h1",{className:"d1",children:"Edit Post"}),Object(f.jsx)("label",{className:"d2",children:"Title"}),Object(f.jsx)("input",{className:"d2field",type:"text",onChange:function(e){h(e.target.value)}}),Object(f.jsx)("label",{className:"d2",children:"Description"}),Object(f.jsx)("input",{className:"d2field",type:"text",onChange:function(e){g(e.target.value)}}),Object(f.jsx)("label",{className:"d2",children:"Price"}),Object(f.jsx)("input",{className:"d2field",type:"text",onChange:function(e){k(e.target.value)}}),Object(f.jsx)("label",{className:"d2",children:"Location"}),Object(f.jsx)("input",{className:"d2field",type:"text",onChange:function(e){w(e.target.value)}}),Object(f.jsx)("button",{className:"submit",children:"Submit"})]}),Object(f.jsx)("button",{className:"close",onClick:function(){return u(!1)},children:"Close "})]})}):null})},P=function(e){var t=e.publicPosts,s=e.setPublicPosts,n=(e.loggedIn,e.setIsLoggedIn,e.isEditClicked,e.setIsEditClicked,Object(i.useState)(null)),o=Object(r.a)(n,2),l=o[0],u=o[1],j=Object(i.useState)(""),d=Object(r.a)(j,2),b=d[0],h=d[1],O=Object(i.useState)([]),m=Object(r.a)(O,2),g=m[0],P=m[1],k=Object(i.useState)(!1),C=Object(r.a)(k,2),y=C[0],S=C[1],w=Object(i.useState)(!1),I=Object(r.a)(w,2),E=I[0],T=I[1];console.log("public posts:",t);var F=function(){var e=Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:T(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(a.a)(c.a.mark((function e(n){var a,r,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("postIdToDelete: ",n),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2104-UIC-RM-WEB-FT/posts/".concat(n),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(p())}});case 3:a=e.sent,r=a.json(),console.log("data",r),r&&(i=t.filter((function(e){return e._id!==n})),s(i));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){P([]),t.filter((function(e){e.title.toLowerCase().includes(b.toLowerCase())&&P((function(t){return[].concat(Object(x.a)(t),[e])}))}))}),[b]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{className:"thesearcher",children:[Object(f.jsx)("h2",{className:"searchposts",children:"Search Posts"}),Object(f.jsx)("div",{className:"search-bar",children:Object(f.jsx)("input",{className:"searchfield",onChange:function(e){return h(e.target.value)},type:"text",placeholder:"Search Title"})}),Object(f.jsx)("button",{className:"addPost",onClick:F,children:"Add Post"})]}),y?Object(f.jsx)(N,{publicPosts:t,setPublicPosts:s,addPostClicked:y,setAddPostClicked:S}):null,b?Object(f.jsxs)(f.Fragment,{children:[E?Object(f.jsx)(v,{publicPosts:t,setPublicPosts:s,postId:l,setPostsId:u,showResults:E,setShowResults:T}):null,Object(f.jsxs)("div",{className:"userposts",children:[" ",g.map((function(e,n){return Object(f.jsxs)("div",{className:"post",children:[Object(f.jsx)("h1",{className:"q1t",children:e.title}),Object(f.jsx)("p",{className:"q1",children:e.description}),Object(f.jsxs)("h3",{className:"q1",children:["Price: ",e.price]}),Object(f.jsxs)("h3",{className:"q1",id:"seller",children:["Seller: ",e.author.username]}),Object(f.jsxs)("h3",{className:"q1",children:["Location: ",e.location]}),Object(f.jsx)("button",{type:"button",className:"edit",onClick:function(){u(e._id),L()},children:"Edit"}),Object(f.jsx)("button",{type:"button",className:"delete",onClick:function(){return q(e._id)},children:"Delete"}),Object(f.jsx)(v,{publicPosts:t,setPublicPosts:s,postId:l,setPostsId:u})]},n)}))]})]}):Object(f.jsxs)(f.Fragment,{children:[E?Object(f.jsx)(v,{publicPosts:t,setPublicPosts:s,postId:l,setPostsId:u,showResults:E,setShowResults:T}):null,Object(f.jsxs)("div",{className:"userposts",children:[" ",t.map((function(e,t){return Object(f.jsxs)("div",{className:"post",children:[Object(f.jsx)("h1",{className:"q1t",children:e.title}),Object(f.jsx)("p",{className:"q1",children:e.description}),Object(f.jsxs)("h3",{className:"q1",children:["Price: ",e.price]}),Object(f.jsxs)("h3",{className:"q1",id:"seller",children:["Seller: ",e.author.username]}),Object(f.jsxs)("h3",{className:"q1",children:["Location: ",e.location]}),Object(f.jsx)("button",{type:"button",className:"edit",onClick:function(){u(e._id),L()},children:"Edit"}),Object(f.jsx)("button",{type:"button",className:"delete",onClick:function(){return q(e._id)},children:"Delete"})]},t)}))]})]})]})},k=function(e){var t=e.currentUser,s=Object(i.useState)([]),n=Object(r.a)(s,2),c=n[0],a=n[1];return Object(i.useEffect)((function(){t().then((function(e){return a(e.data.posts)}))}),[]),console.log("yabba",c),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h1",{className:"myposts",children:"My Posts"}),Object(f.jsx)("div",{className:"userposts",children:c.map((function(e,t){return Object(f.jsxs)("div",{className:"post",children:[Object(f.jsx)("h1",{className:"q1t",children:e.title}),Object(f.jsx)("p",{className:"q1",children:e.description}),Object(f.jsxs)("h3",{className:"q1",children:["Price: ",e.price]}),Object(f.jsxs)("h3",{className:"q1",children:["Location: ",e.location]})]},t)}))})]})},C=function(e){e.currentUser;return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("nav",{className:"navigation",children:[Object(f.jsx)(j.b,{className:"tohome",to:"/",children:" Home "}),Object(f.jsx)(j.b,{className:"toprofile",to:"/profile",children:"Profile"})]})})},y=function(){var e=Object(i.useState)(p()),t=Object(r.a)(e,2),s=t[0],n=t[1],o=Object(i.useState)([]),l=Object(r.a)(o,2),j=l[0],d=l[1],b=function(){var e=Object(a.a)(c.a.mark((function e(){var t,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2104-UIC-RM-WEB-FT/users/me",{headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(p())}});case 2:return t=e.sent,e.next=5,t.json();case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){fetch("https://strangers-things.herokuapp.com/api/2104-UIC-RM-WEB-FT/posts").then((function(e){return e.json()})).then((function(e){return d(e.data.posts)}))}),[]),console.log("public",j),Object(f.jsx)(f.Fragment,{children:Object(f.jsx)("div",{className:"home",children:s?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"header",children:Object(f.jsxs)("div",{className:"topper",children:[Object(f.jsx)(C,{currentUser:b}),Object(f.jsx)("button",{className:"logoutbutton",onClick:function(){localStorage.removeItem("given-token"),n(""),location.assign("/")},children:"Log Out"})]})}),Object(f.jsx)("h1",{className:"stranger",children:"Stranger's Things"}),Object(f.jsx)(u.a,{exact:!0,path:"/",render:function(){return Object(f.jsx)(P,{publicPosts:j,setPublicPosts:d,loggedIn:s,setIsLoggedIn:n})}}),Object(f.jsx)(u.a,{path:"/profile",render:function(){return Object(f.jsx)(k,{currentUser:b})}}),Object(f.jsx)("span",{})]}):Object(f.jsx)(m,{setIsLoggedIn:n})})})};l.a.render(Object(f.jsx)(j.a,{children:Object(f.jsx)(y,{})}),document.getElementById("app"))}},[[35,1,2]]]);
//# sourceMappingURL=main.2d629419.chunk.js.map